function LatLon(t,e,a){"undefined"==typeof a&&(a=6371),this._lat="number"==typeof t?t:"string"==typeof t&&""!=t.trim()?+t:0/0,this._lon="number"==typeof e?e:"string"==typeof e&&""!=e.trim()?+e:0/0,this._radius="number"==typeof a?a:"string"==typeof a&&""!=trim(e)?+a:0/0}var Geo={};Geo.parseDMS=function(t){if("object"==typeof a)throw new TypeError("Geo.parseDMS - dmsStr is [DOM?] object");if("number"==typeof t&&isFinite(t))return Number(t);var e=String(t).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(""==e[e.length-1]&&e.splice(e.length-1),""==e)return 0/0;switch(e.length){case 3:var a=e[0]/1+e[1]/60+e[2]/3600;break;case 2:var a=e[0]/1+e[1]/60;break;case 1:var a=e[0];break;default:return 0/0}return/^-|[WS]$/i.test(t.trim())&&(a=-a),Number(a)},Geo.toDMS=function(t,e,a){if("object"==typeof t)throw new TypeError("Geo.toDMS - deg is [DOM?] object");if(isNaN(t))return null;if("undefined"==typeof e&&(e="dms"),"undefined"==typeof a)switch(e){case"d":a=4;break;case"dm":a=2;break;case"dms":a=0;break;default:e="dms",a=0}switch(t=Math.abs(t),e){case"d":o=t.toFixed(a),100>o&&(o="0"+o),10>o&&(o="0"+o),dms=o+"°";break;case"dm":var n=(60*t).toFixed(a),o=Math.floor(n/60),i=(n%60).toFixed(a);100>o&&(o="0"+o),10>o&&(o="0"+o),10>i&&(i="0"+i),dms=o+"°"+i+"′";break;case"dms":var s=(3600*t).toFixed(a),o=Math.floor(s/3600),i=Math.floor(s/60)%60,r=(s%60).toFixed(a);100>o&&(o="0"+o),10>o&&(o="0"+o),10>i&&(i="0"+i),10>r&&(r="0"+r),dms=o+"°"+i+"′"+r+"″"}return dms},Geo.toLat=function(t,e,a){var n=Geo.toDMS(t,e,a);return null==n?"–":n.slice(1)+(0>t?"S":"N")},Geo.toLon=function(t,e,a){var n=Geo.toDMS(t,e,a);return null==n?"–":n+(0>t?"W":"E")},Geo.toBrng=function(t,e,a){t=(Number(t)+360)%360;var n=Geo.toDMS(t,e,a);return null==n?"–":n.replace("360","0")},window.console||(window.console={log:function(){}}),LatLon.prototype.distanceTo=function(t,e){"undefined"==typeof e&&(e=4);var a=this._radius,n=this._lat.toRad(),o=this._lon.toRad(),i=t._lat.toRad(),s=t._lon.toRad(),r=i-n,c=s-o,d=Math.sin(r/2)*Math.sin(r/2)+Math.cos(n)*Math.cos(i)*Math.sin(c/2)*Math.sin(c/2),l=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),h=a*l;return h.toPrecisionFixed(e)},LatLon.prototype.bearingTo=function(t){var e=this._lat.toRad(),a=t._lat.toRad(),n=(t._lon-this._lon).toRad(),o=Math.sin(n)*Math.cos(a),i=Math.cos(e)*Math.sin(a)-Math.sin(e)*Math.cos(a)*Math.cos(n),s=Math.atan2(o,i);return(s.toDeg()+360)%360},LatLon.prototype.finalBearingTo=function(t){var e=t._lat.toRad(),a=this._lat.toRad(),n=(this._lon-t._lon).toRad(),o=Math.sin(n)*Math.cos(a),i=Math.cos(e)*Math.sin(a)-Math.sin(e)*Math.cos(a)*Math.cos(n),s=Math.atan2(o,i);return(s.toDeg()+180)%360},LatLon.prototype.midpointTo=function(t){lat1=this._lat.toRad(),lon1=this._lon.toRad(),lat2=t._lat.toRad();var e=(t._lon-this._lon).toRad(),a=Math.cos(lat2)*Math.cos(e),n=Math.cos(lat2)*Math.sin(e);return lat3=Math.atan2(Math.sin(lat1)+Math.sin(lat2),Math.sqrt((Math.cos(lat1)+a)*(Math.cos(lat1)+a)+n*n)),lon3=lon1+Math.atan2(n,Math.cos(lat1)+a),lon3=(lon3+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(lat3.toDeg(),lon3.toDeg())},LatLon.prototype.destinationPoint=function(t,e){e="number"==typeof e?e:"string"==typeof e&&""!=e.trim()?+e:0/0,e/=this._radius,t=t.toRad();var a=this._lat.toRad(),n=this._lon.toRad(),o=Math.asin(Math.sin(a)*Math.cos(e)+Math.cos(a)*Math.sin(e)*Math.cos(t)),i=n+Math.atan2(Math.sin(t)*Math.sin(e)*Math.cos(a),Math.cos(e)-Math.sin(a)*Math.sin(o));return i=(i+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(o.toDeg(),i.toDeg())},LatLon.intersection=function(t,e,a,n){return e="number"==typeof e?e:"string"==typeof e&&""!=trim(e)?+e:0/0,n="number"==typeof n?n:"string"==typeof n&&""!=trim(n)?+n:0/0,lat1=t._lat.toRad(),lon1=t._lon.toRad(),lat2=a._lat.toRad(),lon2=a._lon.toRad(),brng13=e.toRad(),brng23=n.toRad(),dLat=lat2-lat1,dLon=lon2-lon1,dist12=2*Math.asin(Math.sqrt(Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1)*Math.cos(lat2)*Math.sin(dLon/2)*Math.sin(dLon/2))),0==dist12?null:(brngA=Math.acos((Math.sin(lat2)-Math.sin(lat1)*Math.cos(dist12))/(Math.sin(dist12)*Math.cos(lat1))),isNaN(brngA)&&(brngA=0),brngB=Math.acos((Math.sin(lat1)-Math.sin(lat2)*Math.cos(dist12))/(Math.sin(dist12)*Math.cos(lat2))),Math.sin(lon2-lon1)>0?(brng12=brngA,brng21=2*Math.PI-brngB):(brng12=2*Math.PI-brngA,brng21=brngB),alpha1=(brng13-brng12+Math.PI)%(2*Math.PI)-Math.PI,alpha2=(brng21-brng23+Math.PI)%(2*Math.PI)-Math.PI,0==Math.sin(alpha1)&&0==Math.sin(alpha2)?null:Math.sin(alpha1)*Math.sin(alpha2)<0?null:(alpha3=Math.acos(-Math.cos(alpha1)*Math.cos(alpha2)+Math.sin(alpha1)*Math.sin(alpha2)*Math.cos(dist12)),dist13=Math.atan2(Math.sin(dist12)*Math.sin(alpha1)*Math.sin(alpha2),Math.cos(alpha2)+Math.cos(alpha1)*Math.cos(alpha3)),lat3=Math.asin(Math.sin(lat1)*Math.cos(dist13)+Math.cos(lat1)*Math.sin(dist13)*Math.cos(brng13)),dLon13=Math.atan2(Math.sin(brng13)*Math.sin(dist13)*Math.cos(lat1),Math.cos(dist13)-Math.sin(lat1)*Math.sin(lat3)),lon3=lon1+dLon13,lon3=(lon3+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(lat3.toDeg(),lon3.toDeg())))},LatLon.prototype.rhumbDistanceTo=function(t){var e=this._radius,a=this._lat.toRad(),n=t._lat.toRad(),o=(t._lat-this._lat).toRad(),i=Math.abs(t._lon-this._lon).toRad(),s=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),r=isFinite(o/s)?o/s:Math.cos(a);Math.abs(i)>Math.PI&&(i=i>0?-(2*Math.PI-i):2*Math.PI+i);var c=Math.sqrt(o*o+r*r*i*i)*e;return c.toPrecisionFixed(4)},LatLon.prototype.rhumbBearingTo=function(t){var e=this._lat.toRad(),a=t._lat.toRad(),n=(t._lon-this._lon).toRad(),o=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(e/2+Math.PI/4));Math.abs(n)>Math.PI&&(n=n>0?-(2*Math.PI-n):2*Math.PI+n);var i=Math.atan2(n,o);return(i.toDeg()+360)%360},LatLon.prototype.rhumbDestinationPoint=function(t,e){var a=this._radius,n=parseFloat(e)/a,o=this._lat.toRad(),i=this._lon.toRad();t=t.toRad();var s=n*Math.cos(t);Math.abs(s)<1e-10&&(s=0);var r=o+s,c=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),d=isFinite(s/c)?s/c:Math.cos(o),l=n*Math.sin(t)/d;return Math.abs(r)>Math.PI/2&&(r=r>0?Math.PI-r:-Math.PI-r),lon2=(i+l+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(r.toDeg(),lon2.toDeg())},LatLon.prototype.rhumbMidpointTo=function(t){lat1=this._lat.toRad(),lon1=this._lon.toRad(),lat2=t._lat.toRad(),lon2=t._lon.toRad(),Math.abs(lon2-lon1)>Math.PI&&(lon1+=2*Math.PI);var e=(lat1+lat2)/2,a=Math.tan(Math.PI/4+lat1/2),n=Math.tan(Math.PI/4+lat2/2),o=Math.tan(Math.PI/4+e/2),i=((lon2-lon1)*Math.log(o)+lon1*Math.log(n)-lon2*Math.log(a))/Math.log(n/a);return isFinite(i)||(i=(lon1+lon2)/2),i=(i+3*Math.PI)%(2*Math.PI)-Math.PI,new LatLon(e.toDeg(),i.toDeg())},LatLon.prototype.lat=function(t,e){return"undefined"==typeof t?this._lat:Geo.toLat(this._lat,t,e)},LatLon.prototype.lon=function(t,e){return"undefined"==typeof t?this._lon:Geo.toLon(this._lon,t,e)},LatLon.prototype.toString=function(t,e){return"undefined"==typeof t&&(t="dms"),Geo.toLat(this._lat,t,e)+", "+Geo.toLon(this._lon,t,e)},"undefined"==typeof Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180}),"undefined"==typeof Number.prototype.toDeg&&(Number.prototype.toDeg=function(){return 180*this/Math.PI}),"undefined"==typeof Number.prototype.toPrecisionFixed&&(Number.prototype.toPrecisionFixed=function(t){var e=this.toPrecision(t);return e=e.replace(/(.+)e\+(.+)/,function(t,e,a){for(e=e.replace(/\./,""),l=e.length-1;a-->l;)e+="0";return e}),e=e.replace(/(.+)e-(.+)/,function(t,e,a){for(e=e.replace(/\./,"");a-->1;)e="0"+e;return"0."+e})}),"undefined"==typeof String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),window.console||(window.console={log:function(){}});var i18n={},locale=window.navigator.language.split("-")[0];switch(locale){case"bg":i18n.geocode_error="Координат не могат да се достъпят. Проверете интернет връзката си.",i18n.geocode_invalid_request="Свържете се с програмиста и докладвайте за грешка с невалидна заявка.",i18n.geocode_over_query_limit="Направили сте прекалено много заявки за твърде кратко време. Опитайте отново след 10 минути.",i18n.geocode_request_denied="Свържете се с програмиста и докладвайте за грешка с отказана заявка.",i18n.geocode_unknown_error="Опа, не успяхме да намерим това, което търсите. Моля опитайте отново.",i18n.geocode_zero_results="Не са намерени резултати за този адрес. Променете адреса и опитайте отново.";break;case"en":default:i18n.geocode_error="Cannot get coordinates for location. Check your internet connection.",i18n.geocode_invalid_request="Contact the developer and let them know that an invalid request error occured.",i18n.geocode_over_query_limit="You have made too many queries for too short time. Try again in 10 minutes.",i18n.geocode_request_denied="Contact the developer and let them know that a request denied error occured.",i18n.geocode_unknown_error="Ooops, we could not find what you were looking for. Please try again.",i18n.geocode_zero_results="No results were found for that address. Please try modifying that and searching again."}com="undefined"==typeof com?{}:com,com.magadanski="undefined"==typeof com.magadanski?{}:com.magadanski,com.magadanski.mSimpleNav="undefined"==typeof com.magadanski.mSimpleNav?{}:com.magadanski.mSimpleNav,Function.prototype.inherits=function(t){return t.constructor==Function?(this.prototype=new t,this.prototype.constructor=this,this.prototype.parent=t.prototype):(this.prototype=t,this.prototype.constructor=this,this.prototype.parent=t),this},com.magadanski.utils="undefined"==typeof com.magadanski.utils?{}:com.magadanski.utils,com.magadanski.utils.getFullHeight=function(t){var e=0;e+="undefined"!=typeof t.clientHeight?t.clientHeight:0;var a=document.defaultView.getComputedStyle(t,"");return"undefined"!=typeof a&&(e+=parseInt(a.getPropertyValue("margin-top")),e+=parseInt(a.getPropertyValue("margin-bottom"))),e},com.magadanski.utils.extendOptions=function(t,e){for(o in e)t[o]=e[o];return t},com.magadanski.EventDispatcher,function(){var t,e=function(){t=this,t.events={}};com.magadanski.EventDispatcher=e,e.prototype.addEventListener=function(t,e){var a=this;"undefined"!=typeof t.split&&(t=t.split(","));for(var n in t){var o=t[n].replace(/\s/,"");"undefined"==typeof a.events[o]&&(a.events[o]=[]),a.events[o].push(e)}},e.prototype.removeEventListener=function(t,e){var a=this;"undefined"!=typeof t.split&&(t=t.split(","));for(var n in t){var o=t[n].replace(/\s/,"");if("undedined"!=typeof a.events[o])for(var i in a.events[o])(i==e||a.events[o][i]==e)&&a.events[o].splice(i,1)}},e.prototype.dispatchEvent=function(t,e){var a=this;if("undefined"==typeof e&&(e={}),"object"==typeof a.events[t])for(var n in a.events[t])e.type=t,e.currentTarget=this,"function"==typeof a.events[t][n]&&a.events[t][n](e)}}(),com.magadanski.App,function(){var t,e=function(){t=this,t.title=document.title};e.inherits(com.magadanski.EventDispatcher),com.magadanski.App=e,e.prototype.title=""}(),com.magadanski.Address,function(){var t,e=function(){function e(t){a=window.location.hash,n=t.state}t=this;var a="",n="";t.getHash=function(){return a},t.setHash=function(e,a,n){var o={hash:t.getHash(),state:t.getState()};o.hash!=e&&(history.pushState(a,n,e),window.dispatchEvent(new PopStateEvent("popstate",{state:n})),t.dispatchEvent("change",{previousHash:o.hash,previousState:o.state}))},t.getState=function(){return n},window.addEventListener("popstate",e)};e.inherits(com.magadanski.EventDispatcher),com.magadanski.Address=e}(),com.magadanski.mSimpleNav.Exception,function(){var t=function(t){var e=this;e.message=t};com.magadanski.mSimpleNav.Exception=t}(),com.magadanski.DOMCollection,function(){var t,a=function(e){t=this,t.elements=[];var a=null;if(a="string"==typeof e?document.querySelectorAll(e):"object"==typeof e?e:!1)for(var n=0;n<a.length;n++)t.elements.push(a.item(n))};com.magadanski.DOMCollection=a,a.prototype.addEventListener=function(t,a){for(e in this.elements)this.elements[e].addEventListener(t,a)},a.prototype.removeEventListener=function(t){for(e in this.elements)this.elements[e].removeEventListener(t,callback)},a.prototype.addClass=function(t){for(e in this.elements)this.elements[e].classList.add(t)},a.prototype.removeClass=function(t){for(e in this.elements)this.elements[e].classList.remove(t)},a.prototype.each=function(t){for(e in this.elements)t(e,this.elements[e])},a.prototype.filter=function(t){var n=new a;for(e in this.elements)this.elements[e].matches(t)&&n.elements.push(this.elements[e]);return n}}(),com.magadanski.mSimpleNav.Location,function(){var t=function(t){var e=this;"number"==typeof t.lat&&(e.lat=t.lat),"number"==typeof t.lng&&(e.lng=t.lng),"string"==typeof t.name&&(e.name=t.name)};t.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.Location=t,t.prototype.lat=0,t.prototype.lng=0,t.prototype.name=""}(),com.magadanski.mSimpleNav.GPS,function(){var t=function(t){var e=this;"undefined"==typeof t&&(t=!0),e.highAccuracy=!!t,navigator.geolocation&&(currentLocationTimeout=navigator.geolocation.watchPosition(function(t){e.position=new LatLon(t.coords.latitude,t.coords.longitude),e.dispatchEvent("positionChange",{message:"device position has changed",lat:e.position.lat(),lng:e.position.lon()})},function(){e.dispatchEvent("positionFault",{message:"no information on device position"})},{enableHighAccuracy:!!e.highAccuracy}))};t.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.GPS=t,t.prototype.position=null,t.prototype.highAccuracy=!0,t.prototype.getDistanceTo=function(t){var e=this,a="";return e.position instanceof LatLon&&t instanceof LatLon&&(a=e.position.distanceTo(t)),a},t.prototype.getBearingTo=function(t){var e=this,a=0;return e.position instanceof LatLon&&t instanceof LatLon&&(a=e.position.bearingTo(t)),a}}(),com.magadanski.mSimpleNav.Compass,function(){var t=function(){var t=this;window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(e){e.absolute?t.compassHeading=-e.alpha:"undefined"!=typeof e.webkitCompassHeading&&(t.compassHeading=e.webkitCompassHeading),t.dispatchEvent("compassupdate",{message:"compass data has changed",deviceBearing:t.compassHeading})})};t.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.Compass=t,t.prototype.compassHeading=0,t.prototype.getDeviceBearing=function(){var t=this;return t.compassHeading}}(),com.magadanski.mSimpleNav.Storage,function(){function t(t){return Array(t.length+1).join("?").split("").join(", ")}var e=function(t){var e=this;e.db=openDatabase("mSimpleNavFavorites","1.0","M Simple Nav Favorites",2097152),e.db.transaction(function(e){if("undefined"!=typeof t)for(var a in t){var n=[],o="";for(var i in t[a])o=i,"undefined"!=typeof t[a][i].type&&(o+=" "+t[a][i].type),t[a][i].primaryKey&&(o+=" PRIMARY KEY"),t[a][i].autoIncrement&&(o+=" AUTOINCREMENT"),t[a][i].unique&&(o+=" UNIQUE"),n.push(o);q=n.join(", "),e.executeSql("CREATE TABLE IF NOT EXISTS "+a+"("+q+")",null,function(){},function(){alert("There was an error with setting up favorites data storage. Please contact the developer.")})}})};e.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.Storage=e,e.prototype.db=null,e.prototype.add=function(e,a,n){var o=this;o.db.transaction(function(i){var s=[],r=[];for(var c in a)s.push(c),r.push(a[c]);var d=t(r);i.executeSql("INSERT INTO "+e+"("+s.join(", ")+") VALUES("+d+")",r,function(t,e){o.dispatchEvent("insert",{tx:t,results:e}),"function"==typeof n&&n(t,e)},function(){alert("There was an error saving your location. Please try again. If this remains happening contact the developer.")})})},e.prototype.get=function(t,e,a){var n=this;n.db.transaction(function(n){var o="SELECT ",i=" FROM "+t,s="",r=[];if(o+="undefined"!=typeof e.fields?e.fields.join(", "):"*","undefined"!=typeof e.conditions){s+=" WHERE ";var c=[];for(var d in e.conditions)"undefined"==typeof e.conditions.operator&&(e.conditions.operator="="),c.push(e.conditions[d].field+" "+e.conditions.operator+" ?"),r.push(e.conditions[d].value)}n.executeSql(o+i+s,r,function(t,e){"function"==typeof a&&a(e)},function(){alert("Could not retrieve entries. Please contact developer.")})})}}(),com.magadanski.mSimpleNav.DataList,function(){var t=function(t){var e=this,a=[];"object"!=typeof t&&(t={}),"function"!=typeof t.startList&&(t.startList=function(){return"<ul>"}),"function"!=typeof t.endList&&(t.endList=function(){return"</ul>"}),"function"!=typeof t.renderItem&&(t.renderItem=function(t){return"<li>"+t+"</li>"}),e.startList=t.startList,e.endList=t.endList,e.renderItem=t.renderItem,e.getData=function(t){var e=a;return"undefined"!=typeof t&&"undefined"!=typeof a[t]&&(e=a[t]),e},e.setData=function(t,n){"undefined"!=typeof n?a[n]=t:a=[].concat(t),e.dispatchEvent("dataChanged",{message:"list data has changed"})},e.addData=function(t){a=a.concat(t),e.dispatchEvent("dataChanged",{message:"list data has changed"})},e.clearData=function(t){if("undefined"!=typeof t){if("undefined"==typeof a[t])throw new com.magadanski.Exception("index "+t+" does not exist in data array");a[t]=null}else a=[];e.dispatchEvent("dataChanged",{message:"list data has changed"})}};t.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.DataList=t,t.prototype.render=function(){var t=this,e="",a=t.getData();e+=t.startList();for(var n in a)e+=t.renderItem(a[n]);return e+=t.endList()}}(),com.magadanski.mSimpleNav.LocationsDataList,function(){var t=function(){var t=this;t.renderItem=function(t){return'<li><a href="#" data-location-id="'+t.id+'" data-location-lat="'+t.lat+'" data-location-lng="'+t.lng+'">'+t.name+"</a></li>"}};t.inherits(com.magadanski.mSimpleNav.DataList),com.magadanski.mSimpleNav.LocationsDataList=t}(),com.magadanski.mSimpleNav.Navigation,function(){var t,e=function(e){function a(e){e.stopPropagation(),e.preventDefault(),t.lis.removeClass(n),e.target.parentNode.classList.add(n),t.dispatchEvent("change",{href:e.target.getAttribute("href")})}t=this;var n="active";t.container=document.querySelector(e),t.container.object=t,t.lis=new com.magadanski.DOMCollection(t.container.querySelectorAll("li")),t.links=new com.magadanski.DOMCollection(t.container.querySelectorAll("a")),t.links.addEventListener("click",a)};e.inherits(com.magadanski.EventDispatcher),com.magadanski.mSimpleNav.Navigation=e,e.prototype.goTo=function(t){var e=this.container.querySelector('a[href="'+t+'"]');(e.getAttribute("href")==t||e.href==t)&&e.dispatchEvent(new Event("click"))}}(),com.magadanski.mSimpleNav.Views,function(){var t,e=com.magadanski.utils.getFullHeight,a=function(a){t=this;var n=document.querySelector(a),o=new com.magadanski.DOMCollection(n.querySelectorAll(":scope > *"));this.getView=function(t){var e=!1;return"undefined"!=typeof o.elements[t]&&(e=o.elements[t]),e},this.getViews=function(){return o},this.updateViewArea=function(t){activeView="undefined"!=typeof t?o.filter(t.currentTarget.getHash()).elements[0]:o.elements[0];var a=0;o.each(function(t,e){e.getAttribute("id")==activeView.getAttribute("id")&&(a=t)}),n.style.transform="translateX(-"+100*a*(1/o.elements.length)+"%)",n.style.height=e(activeView)+"px"},t.updateViewArea()};com.magadanski.mSimpleNav.Views=a}(),com.magadanski.mSimpleNav.MSimpleNav,function(){var t,e=function(){function e(){var a=t.gps.getBearingTo(t.destination)-t.compass.getDeviceBearing();t.displayBearing=Math.abs(t.displayBearing-a)<Math.abs(360+t.displayBearing-a)?a:a-360,document.getElementById("distance").innerText=t.gps.getDistanceTo(t.destination)+" km",document.getElementById("compass").style.webkitTransform="rotateZ("+t.displayBearing+"deg)",setTimeout(e,100)}function a(e){switch(e.status){case google.maps.GeocoderStatus.OK:var a=e.result[0].geometry.location;t.setDestination(a.lat(),a.lng());break;case google.maps.GeocoderStatus.ERROR:alert(i18n.geocode_error);break;case google.maps.GeocoderStatus.INVALID_REQUEST:alert(i18n.geocode_invalid_request);break;case google.maps.GeocoderStatus.OVER_QUERY_LIMIT:alert(i18n.geocode_over_query_limit);break;case google.maps.GeocoderStatus.REQUEST_DENIED:alert(i18n.geocode_request_denied);break;case google.maps.GeocoderStatus.UNKNOWN_ERROR:alert(i18n.geocode_unknown_error);break;case google.maps.GeocoderStatus.ZERO_RESULTS:alert(i18n.geocode_zero_results)}}function n(e){for(var a=[],n=0;n<e.rows.length;n++)a.push(e.rows.item(n));t.favoriteLocations.setData(a)}function o(){t.getLocations(n)}t=this;var i={locations:{id:{type:"INTEGER",primaryKey:!0,autoIncrement:!0},name:{type:"TEXT"},lat:{type:"TEXT"},lng:{type:"TEXT"}}};t.gps,t.compass,t.displayBearing,t.destination,t.geocoder,t.storage,t.favoriteLocations,t.geocoder=new google.maps.Geocoder,t.gps=new com.magadanski.mSimpleNav.GPS(!0),t.compass=new com.magadanski.mSimpleNav.Compass,t.storage=new com.magadanski.mSimpleNav.Storage(i),t.favoriteLocations=new com.magadanski.mSimpleNav.LocationsDataList,t.addEventListener("geocoded",a),t.addEventListener("locationsUpdated",o),t.getLocations(n),e()};e.inherits(com.magadanski.App),com.magadanski.mSimpleNav.MSimpleNav=e,e.prototype.setDestination=function(t,e){for(var a=this;t>90;)t-=180;for(;-90>t;)t+=180;for(;e>180;)e-=360;for(;-180>e;)t+=360;a.destination=new LatLon(t,e),a.dispatchEvent("destinationChange",{message:"destination has changed",lat:t,lng:e})},e.prototype.geocode=function(t){var e=this;e.geocoder.geocode({address:t},function(t,a){e.dispatchEvent("geocoded",{result:t,status:a})})},e.prototype.saveLocation=function(t,e,a){var n=this,o={name:t,lat:e,lng:a};n.storage.add("locations",o,function(t,e){n.dispatchEvent("locationsUpdated",{results:e})})},e.prototype.getLocations=function(t){var e=this;e.storage.get("locations",{},t)}}(),document.addEventListener("DOMContentLoaded",function(){var t=com.magadanski.utils.getFullHeight;address=new com.magadanski.Address,app=new com.magadanski.mSimpleNav.MSimpleNav,navigation=new com.magadanski.mSimpleNav.Navigation(".tabs"),views=new com.magadanski.mSimpleNav.Views(".views"),addressForm=document.getElementById("address-form"),coordinatesForm=document.getElementById("coordinates-form"),favoritesForm=document.getElementById("favorites-form"),navigation.addEventListener("change",function(t){address.setHash(t.href,app.title)}),address.addEventListener("change",views.updateViewArea),""===address.getHash()&&navigation.goTo("#"+views.getViews().elements[0].getAttribute("id")),coordinatesForm.addEventListener("submit",function(t){t.preventDefault(),app.setDestination(document.getElementById("lat").value,document.getElementById("lng").value)}),addressForm.addEventListener("submit",function(t){t.preventDefault(),app.addEventListener("destinationChange",function(t){document.getElementById("lat").value=t.lat,document.getElementById("lng").value=t.lng}),app.geocode(document.getElementById("address").value)}),favoritesForm.addEventListener("submit",function(t){t.preventDefault();var e=prompt("Name this location",document.getElementById("address").value),a=document.getElementById("lat").value,n=document.getElementById("lng").value;app.saveLocation(e,a,n)}),app.favoriteLocations.addEventListener("dataChanged",function(){var e=favoritesForm.querySelector("ul");e&&e.remove(),favoritesForm.innerHTML=app.favoriteLocations.render()+favoritesForm.innerHTML;var a=document.querySelector(".views"),n=address.getHash();if(n.length>1){var o=document.querySelector(address.getHash());a.style.height=t(o)+"px"}var i=favoritesForm.querySelectorAll("ul a");if(i.length)for(var s=0;s<i.length;s++)i.item(s).addEventListener("click",function(t){t.preventDefault(),app.setDestination(t.currentTarget.dataset.locationLat,t.currentTarget.dataset.locationLng)})}),window.location.hash&&navigation.goTo(window.location.hash),navigator.userAgent.match(/(iPhone|iPod|iPad)/)&&(document.body.style.borderTop="24px solid #000")});